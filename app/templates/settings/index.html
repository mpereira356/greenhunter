{% extends "base.html" %}
{% block title %}Configuracoes{% endblock %}
{% block content %}
<div class="page-header">
  <div>
    <div class="page-title">Configuracoes</div>
    <div class="page-subtitle">Conecte seu Telegram e teste notificacoes.</div>
  </div>
</div>

<div class="row g-3">
  <div class="col-lg-5">
    <div class="card">
      <div class="card-body">
        <h5 class="mb-3">Dados do Telegram</h5>
        <form method="post" class="mb-3">
          <div class="mb-3">
            <label class="form-label">Telegram token</label>
            <input class="form-control" name="telegram_token" value="{{ current_user.telegram_token or '' }}">
          </div>
          <div class="mb-3">
            <label class="form-label">Telegram chat_id</label>
            <input class="form-control" name="telegram_chat_id" value="{{ current_user.telegram_chat_id or '' }}">
          </div>
          <div class="d-flex gap-2">
            <button class="btn btn-primary" type="submit">Salvar</button>
            <button class="btn btn-outline-secondary" form="test-telegram-form" type="submit">Testar Telegram</button>
          </div>
        </form>
        <form id="test-telegram-form" method="post" action="{{ url_for('settings.test_telegram') }}"></form>
      </div>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title mb-3">Passo a passo: criar bot e pegar o chat_id</h5>
        <ol class="mb-0">
          <li>No Telegram, abra o @BotFather e crie um bot com o comando /newbot.</li>
          <li>Copie o token gerado pelo BotFather e cole no campo "Telegram token".</li>
          <li>Crie um grupo no Telegram e adicione o seu bot no grupo.</li>
          <li>Adicione o bot @getidsbot no grupo.</li>
          <li>O @getidsbot vai responder com algo como:</li>
        </ol>
        <pre class="mt-2 mb-0">This chat
id: -1009876543210</pre>
      </div>
    </div>
  </div>
</div>
{% endblock %}
